# This file contains common pin mappings for the BIGTREETECH Manta M8P V2.0
# To use this config, the firmware should be compiled for the
# STM32H723 with a "128KiB bootloader" "25 MHz crystal"
# and "USB (on PA11/PA12)", "CAN bus (on PD0/PD1)" or Serial (on USART1 PA10/PA9).

# See docs/Config_Reference.md for a description of parameters.

[include shell_command.cfg]
[include mainsail.cfg]
[include timelapse.cfg]
[include Addons/Stealthburner_Led.cfg]
[include Addons/underglow.cfg]
[include Addons/KAMP_Settings.cfg]
[include Addons/input_shaper.cfg]
[include Macros.cfg]
[include fan_tach_monitor.cfg]
[exclude_object]

#################################################
#                  MCU'S
#################################################

[mcu]      
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_450018000551323235363233-if00
restart_method: command    

[mcu nhk]
serial: /dev/serial/by-id/usb-Klipper_rp2040_4E363334320E6F13-if00
restart_method: command

[force_move]
enable_force_move: True

[gcode_arcs]                       
resolution: 1.0

[idle_timeout]
gcode:
#   A list of G-Code commands to execute on an idle timeout. See
#   docs/Command_Templates.md for G-Code format. The default is to run
#   "TURN_OFF_HEATERS" and "M84".
timeout: 3600

# [idle_timeout]
# gcode: _IDLE_TIMEOUT
# timeout: 3600

# [neopixel my_neopixel]
# pin: nhk:gpio7 
# #   The pin connected to the neopixel. This parameter must be
# #   provided.
# chain_count: 4
# #   The number of Neopixel chips that are "daisy chained" to the
# #   provided pin. The default is 1 (which indicates only a single
# #   Neopixel is connected to the pin).
# color_order:  RGB,RGB,RGB,RGB
# #   Set the pixel order required by the LED hardware (using a string
# #   containing the letters R, G, B, W with W optional). Alternatively,
# #   this may be a comma separated list of pixel orders - one for each
# #   LED in the chain. The default is GRB.
# initial_RED: 1.0
# initial_GREEN: 1.0
# initial_BLUE: 1.0
# initial_WHITE: 1.0
# #   See the "led" section for information on these parameters.


###############################################
#            Temp Sensors
###############################################

[temperature_sensor Manta_M8P]         
sensor_type: temperature_mcu
min_temp:0
max_temp:100

[temperature_sensor CB1]     
sensor_type: temperature_host
min_temp: 0
max_temp: 110

[temperature_sensor NH36]
sensor_type: temperature_mcu
sensor_mcu: nhk
min_temp: 0
max_temp: 100

[temperature_sensor chamber]
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PB0

[virtual_sdcard]
path: ~/printer_data/gcodes
on_error_gcode: CANCEL_PRINT

[pause_resume]

[printer]
kinematics: corexy
max_velocity: 700
max_accel: 3600
# max_accel_to_decel: 4500
max_z_velocity: 15
max_z_accel: 500
square_corner_velocity: 5.0

# [printer]
# kinematics: corexy
# max_velocity: 300
# max_accel: 3000
# max_z_velocity: 5
# max_z_accel: 100
# square_corner_velocity: 5.0

[input_shaper]
damping_ratio_x: 0.001
damping_ratio_y: 0.001

########################################
#        stepper auto tune
#########################################

[autotune_tmc stepper_x]
motor: Shengyang-42BYGH2904-A-24NQ1
tuning_goal: performance
#sg4_thrs: 75
[autotune_tmc stepper_y]
motor: Shengyang-42BYGH2904-A-24NQ1
tuning_goal: performance
#sg4_thrs: 75

[autotune_tmc stepper_z]
motor: Shengyang-42BYGH1603-A-20DNT
tuning_goal: silent                 #performance
[autotune_tmc stepper_z1]
motor: Shengyang-42BYGH1603-A-20DNT
tuning_goal: silent                 #performance
[autotune_tmc stepper_z2]
motor: Shengyang-42BYGH1603-A-20DNT
tuning_goal: silent                 #performance
[autotune_tmc stepper_z3]
motor: Shengyang-42BYGH1603-A-20DNT
tuning_goal: silent                 #performance

# # [autotune_tmc extruder]
# # motor: Shengyang-36BYG1510-1M-6QT 

# [autotune_tmc extruder]
# motor: ldo-36sth20-1004ahg
# tuning_goal: performance


# comment out the driver_sgthrs lines in x and y steppers, set interpolate: true for all steppers

# finally add these 3 blocks to the motor_database.cfg file:
# [motor_constants Shengyang-36BYG1510-1M-6QT] #extruder
# resistance: 2.4
# inductance: 0.0087
# holding_torque: 0.28
# max_current: 0.8
# steps_per_revolution: 200

# [motor_constants ldo-36sth20-1004ahg]
# resistance: 2.4
# inductance: 0.0014
# holding_torque: 0.10
# max_current: 1.0
# steps_per_revolution: 200

[motor_constants Shengyang-42BYGH1603-A-20DNT] #z
resistance: 6
inductance: 0.0087
holding_torque: 0.28
max_current: 0.566                                               #0.8
steps_per_revolution: 200

[motor_constants Shengyang-42BYGH2904-A-24NQ1] #x and y
resistance: 1
inductance: 0.0020 
holding_torque: 0.42
max_current: 1.0                   #1.061                                           #1.5
steps_per_revolution: 200


#########################################
#             stepper x
#########################################

##  B Stepper - Left
[stepper_x]
step_pin: PG13
dir_pin: PG12
enable_pin: !PG15
microsteps: 16
rotation_distance: 40
full_steps_per_rotation:200
endstop_pin: nhk:gpio13                                         #PC15
position_endstop: 358
position_max: 358
homing_speed: 80

[tmc2209 stepper_x]
uart_pin: PG14
interpolate: True  
run_current: 1.0                 #1.061  #1.5                          
sense_resistor: 0.150
stealthchop_threshold: 999999

#######################################
#           stepper y
#######################################

##  A Stepper - Right
[stepper_y]
step_pin: PG9
dir_pin: PD7
enable_pin: !PG11
microsteps: 16
rotation_distance: 40
full_steps_per_rotation:200
endstop_pin: PF0                                              #nhk:gpio13 
position_endstop: 365
position_max: 365
homing_speed: 80

[tmc2209 stepper_y]
uart_pin: PG10
interpolate: True  
run_current: 1.0                          #1.061  #1.5
stealthchop_threshold: 0
# stealthchop_threshold: 999999

######################################
#           stepper Z
######################################

[stepper_z] #motherboard：Z3 
step_pin: PE2    
dir_pin: !PE1    
enable_pin: !PE4   
rotation_distance: 40         
gear_ratio: 80:12             
microsteps: 16                
endstop_pin: probe:z_virtual_endstop           
position_max: 347             
position_min: -10              
#position_endstop: 0
homing_speed: 15.0
homing_retract_dist: 5.0
homing_retract_speed: 15.0
second_homing_speed: 10.0

[tmc2209 stepper_z]
uart_pin: PE3
interpolate: true             
run_current: 0.566                    
sense_resistor: 0.150
# stealthchop_threshold: 0
stealthchop_threshold: 999999

######################################
#           stepper Z1
######################################

[stepper_z1] ##motherboard：Z1
step_pin:PB4  
dir_pin: PB3 
enable_pin:!PB6 
rotation_distance: 40         
gear_ratio: 80:12            
microsteps: 16

[tmc2209 stepper_z1]
uart_pin: PB5
interpolate: true             
run_current: 0.566                    
sense_resistor: 0.150         
stealthchop_threshold: 999999

######################################
#           stepper Z2
######################################

[stepper_z2] ##motherboard：Z2
step_pin: PB8
dir_pin: !PB7   
enable_pin:!PE0
rotation_distance: 40         
gear_ratio: 80:12             
microsteps: 16 

[tmc2209 stepper_z2]
uart_pin: PB9
interpolate: true             
run_current: 0.566           
sense_resistor: 0.150         
stealthchop_threshold: 999999

######################################
#           stepper Z3
######################################

[stepper_z3] ##motherboard：Z4
step_pin: PE6 
dir_pin: PE5
enable_pin: !PC14  
rotation_distance: 40         
gear_ratio: 80:12             
microsteps: 16

[tmc2209 stepper_z3]
uart_pin: PC13
interpolate: true             
run_current: 0.566           
sense_resistor: 0.150         
stealthchop_threshold: 999999

#######################################
#          extruder
#######################################

[extruder]
step_pin: nhk:gpio23
dir_pin: !nhk:gpio24
enable_pin: !nhk:gpio25
heater_pin: nhk:gpio9
sensor_pin: nhk:gpio29
pullup_resistor: 2200
microsteps: 16
rotation_distance:  48.02976                                       #46.617                                  #47.088 
gear_ratio: 9:1
full_steps_per_rotation: 200 
nozzle_diameter: 0.400        
filament_diameter: 1.75   
sensor_type: ATC Semitec 104NT-4-R025H42G                                   #my_thermistor_e   
min_temp: 0                  
max_temp: 305                 
max_power: 1.0                
min_extrude_temp: 0
max_extrude_cross_section: 5
max_extrude_only_distance: 500.0
max_extrude_only_velocity: 500                                                #1500
pressure_advance: 0.025       
pressure_advance_smooth_time: 0.035
#control: pid
#pid_Kp: 22.2
#pid_Ki: 1.08
#pid_Kd: 114

[tmc2209 extruder]
sense_resistor: 0.100
uart_pin: nhk:gpio0
tx_pin: nhk:gpio1
interpolate: false                                      #false            
run_current: 0.5           
hold_current: 0.3
stealthchop_threshold: 999999

# [firmware_retraction]
# retract_length: 1.5
# retract_speed: 40
# unretract_speed: 40

###########################################
#               probe
###########################################

[probe]
pin: !nhk:gpio10    
x_offset: 0
y_offset: 0
#z_offset: -1.900
lift_speed: 30
activate_gcode:
    {% set PROBE_TEMP = 150 %}
    {% set MAX_TEMP = PROBE_TEMP + 5 %}
    {% set ACTUAL_TEMP = printer.extruder.temperature %}
    {% set TARGET_TEMP = printer.extruder.target %}

    {% if TARGET_TEMP > PROBE_TEMP %}
        { action_respond_info('Extruder temperature target of %.1fC is too high, lowering to %.1fC' % (TARGET_TEMP, PROBE_TEMP)) }
        M109 S{ PROBE_TEMP }
    {% else %}
        # Temperature target is already low enough, but nozzle may still be too hot.
        {% if ACTUAL_TEMP > MAX_TEMP %}
            { action_respond_info('Extruder temperature %.1fC is still too high, waiting until below %.1fC' % (ACTUAL_TEMP, MAX_TEMP)) }
            TEMPERATURE_WAIT SENSOR=extruder MAXIMUM={ MAX_TEMP }
        {% endif %}
    {% endif %}    
    
# # x_offset: 0                                       #-16.8                   #-17                  
# # y_offset: 34
# # speed: 80
# # z_offset: 0.0
###################################
#         filament detect
##################################

[filament_switch_sensor filament_sensor]
pause_on_runout: True
event_delay: 3.0
pause_delay: 0.5
switch_pin: !PB10                        #PB10                                     #PC15
  
###################################
#             bed
###################################

[thermistor my_thermistor]
temperature1:25
resistance1:100000
temperature2:50
resistance2:18085.4
temperature3:100
resistance3:5362.6


[heater_bed]
heater_pin: PA1                                                         #PF5
sensor_pin: PB1 # TB 
sensor_type: my_thermistor                                              #ATC Semitec 104GT-2
#control: pid
min_temp: 0
max_temp: 130
#pid_Kp: 22.2
#pid_Ki: 1.08
#pid_Kd: 114

##########################################
#        Homing and Bed Mesh
##########################################

[homing_override]
gcode:
  # Move 5 up, just in case (this is our safety zhop, this needs 'set_position_z: 0' below)
  STATUS_HOMING
  UNDERGLOW_HOMING
  G91 ; set relative positioning
  G0 Z5 F1000 ; 5 up zhop
  {% if not rawparams or 'Y' in rawparams %}
    {action_respond_info('Homing Y')}
    G28 Y
    G90 ; set absolute positioning
    G0 Y180 F6000 ; return to center                                #Y177.5
    M400 ; Wait for move to finish
  {% endif %}
  {% if not rawparams or 'X' in rawparams %}
    {action_respond_info('Homing X')}
    G28 X
    G90 ; set absolute positioning
    G0 Y180 F6000 ; return to center
    M400 ; Wait for move to finish
  {% endif %}
  {% if not rawparams or 'Z' in rawparams %}
    {action_respond_info('Homing Z')}
    G90 ; set absolute positioning
    G0 X177.5 Y180 F6000 ; return to center, please add your offsets manually if you want to
    G28 Z
    G0 Z10 F1000 ; move to z10 before probe
    G0 Z2 F1000 ; move to z2 to finish
    M400 ; Wait for move to finish
    # PROBE_EDDY_NG_PROBE_STATIC HOME_Z=1
    G0 Z5 F1000 ; 5mm up
    M400 ; Wait for move to finish
  {% endif %}
  G90 ; set absolute positioning
    STATUS_READY
    UNDERGLOW_STANDBY
axes: xyz
set_position_z: 0 # This forces the z position to be at 0 when we start homing, so we can move the Z up before homing.


# axes: z
# # speed: 200  
# set_position_z: 0
# gcode:
#     STATUS_HOMING
#     UNDERGLOW_HOMING
#     G0 Z10 F5000
#     G90
#     G28 Y346 X358
#     # Attach_Probe
#     G0 X179 Y182 F4000
#     G28 Z0
#     G0 Z20 F4000
#     G90
#     # G0 X42.00 F4000
#     # G0 Y346
#     G0 X179 F4000
#     G0 Y182 F4000
#     G90
#     STATUS_READY
#     UNDERGLOW_STANDBY

[bed_mesh]
speed: 300                                         #120                   
horizontal_move_z: 5        
mesh_min: 20,40              
mesh_max: 333,340            
probe_count: 9,9             
algorithm: bicubic   
bicubic_tension: 0.4
split_delta_z: 0.016
mesh_pps:3,3
adaptive_margin: 5
fade_start: 0
fade_end: 10
fade_target: 0
zero_reference_position: 175,175

######################################
#        Quad Gantry Level
######################################

[quad_gantry_level]
gantry_corners:
	-60,-10
	410,420
points:
	25,25
	25,325
	325,325
	325,25
# gantry_corners:              
#     -60,-10
#     410,420
# points:
#     20,20
#     20,300
#     326,300
#     326,20
speed: 300                                #120                                  #400                   
horizontal_move_z: 10                        #5             #10       
retry_tolerance: 0.0075                        #0.0125          #0.05      
retries: 10                  
max_adjust: 30

##################################################
#                   Fans
##################################################

[fan_generic Part_cooling] # front model cooling fan
# [fan]
pin: nhk:gpio6
# pin: extra_mcu:PB1
# max_power: 1.0
kick_start_time: 0.5

[multi_pin my_controller_fan_pins]
pins: PF9, PF6

# [temperature_fan controller_fan]
# pin: multi_pin:my_controller_fan_pins                                                   #PB14
# kick_start_time: 0.5
# max_power: 1.0
# min_temp: 0
# max_temp: 80
# hardware_pwm: true
# target_temp: 40
# sensor_type: temperature_host
# max_speed: 1.0
# min_speed: 0.1
# control: pid
# pid_Kp: 2.0     ;40
# pid_Ki: 5.0     ;0.2
# pid_Kd: 0.5     ;0.1
# pid_deriv_time: 2.0

[controller_fan driver_fan]      # Driver cooling fan
pin: multi_pin:my_controller_fan_pins                            #PF9                         # multi_pin:my_controller_fan_pins                          # Fan pin 
cycle_time: 0.00003              # Cycle time
max_power: 1.0                   # Maximum power
shutdown_speed: 0.0              # Shutdown speed
fan_speed: 1.0                   # 1.0                 #0.8                   # Fan speed when heater or stepper driver is active (0.0 to 1.0). Default is 1.0.
idle_timeout: 90                 # Time in seconds to keep the fan running after the stepper driver or heater is no longer active. Default is 30 seconds.
idle_speed: 0.4                  # Fan speed after the stepper driver is no longer active and before idle_timeout is reached (0.0 to 1.0). Default is fan_speed.
stepper: stepper_x               # Active motors
#Define the name of the heater/stepper configuration section associated with this fan. 
#If a comma-separated list of heater/stepper names is provided here, the fan will be enabled when any of the given heaters/steppers are enabled.
#The default heater is "extruder", and the default stepper is all steppers.

[heater_fan cb1_fan]
pin: PA4                                         #multi_pin:my_controller_fan_pins  
max_power: 1.0
shutdown_speed: 0.0               
kick_start_time: 2.0
cycle_time: 0.01
heater: extruder             
heater_temp: 5
fan_speed: 1.0
# max_power: 1.0

[heater_fan controller_fan]
pin: PF8                                         #multi_pin:my_controller_fan_pins  
max_power: 1.0
shutdown_speed: 0.0               
kick_start_time: 2.0
cycle_time: 0.01
heater: extruder             
heater_temp: 5
fan_speed: 0.8
# max_power: 1.0

## HEF
[heater_fan hotend_fan]
pin: nhk:gpio5
max_power:1.0
kick_start_time: 0.5
heater: extruder
heater_temp: 50.0
tachometer_pin: nhk:gpio16
# tachometer_ppr: 2
tachometer_poll_interval: 0.00015
fan_speed: 1.0

# [fan_generic nitehawk]
# pin:nhk:gpio3
# max_power: 1.0

# [temperature_fan Chamber]
# pin: PF8
# kick_start_time: 0.5
# max_power: 1.0
# min_temp: 0
# max_temp: 80
# hardware_pwm: true
# target_temp: 60                              #40
# sensor_type: EPCOS 100K B57560G104F                                                       #temperature_host
# sensor_pin: PB0
# max_speed: 1.0
# min_speed: 0.1
# control: pid
# pid_Kp: 2.0     ;40
# pid_Ki: 5.0     ;0.2
# pid_Kd: 0.5     ;0.1
# pid_deriv_time: 2.0

# [heater_fan hotend_fan]
# pin: nhk:gpio5   
# max_power: 1.0               
# kick_start_time: 0.5         
# heater: extruder             
# heater_temp: 50

#################################################
#                 Nevermore
#################################################

# Slicer integration: Add "SET_FAN_SPEED FAN=Nevermore SPEED=1" in your start-macro
# (or less fan depending on your needs, like SPEED=0.8)
# in your end print code, add "UPDATE_DELAYED_GCODE ID=filter_off DURATION=180"
# this keeps your Nevermore running for 180s after the print finishes to clean the chamber a bit more.

[fan_generic Nevermore]
## Nevermore - FAN5 on Octopus
## Adjust if you use a different board or a different terminal.
pin: PF7

[delayed_gcode filter_off]
gcode:
    SET_FAN_SPEED FAN=Nevermore SPEED=0
    
[gcode_macro TOGGLE_NEVERMORE]
gcode:
    {% if printer['fan_generic Nevermore'].speed > 0 %}
    SET_FAN_SPEED FAN=Nevermore SPEED=0
    {% else %}
    SET_FAN_SPEED FAN=Nevermore SPEED=1
    {% endif %}
    
####################################
#           Main LED
####################################
    
[output_pin main_led]
pin:PA3
pwm: 1
value:1
cycle_time: 3

###########################################################################################################################################################################################

# [homing_override]
# gcode:
#   # Move 5 up, just in case (this is our safety zhop, this needs 'set_position_z: 0' below)
#    STATUS_HOMING
#    UNDERGLOW_HOMING
#   G91 ; set relative positioning
#   G0 Z5 F1000 ; 5 up zhop
#   {% if not rawparams or 'Y' in rawparams %}
#     {action_respond_info('Homing Y')}
#     G28 Y
#     G90 ; set absolute positioning
#     G0 Y177.5 F6000 ; return to center
#     M400 ; Wait for move to finish
#   {% endif %}
#   {% if not rawparams or 'X' in rawparams %}
#     {action_respond_info('Homing X')}
#     G28 X
#     G90 ; set absolute positioning
#     G0 X177.5 F6000 ; return to center
#     M400 ; Wait for move to finish
#   {% endif %}
#   {% if not rawparams or 'Z' in rawparams %}
#     {action_respond_info('Homing Z')}
#     G90 ; set absolute positioning
#     G0 X177.5 Y177.5 F6000 ; return to center, please add your offsets manually if you want to
#     G28 Z
#     G0 Z10 F1000 ; move to z10 before probe
#     G0 Z2 F1000 ; move to z2 to finish
#     M400 ; Wait for move to finish
#     PROBE_EDDY_NG_PROBE_STATIC HOME_Z=1
#     G0 Z5 F1000 ; 5mm up
#     M400 ; Wait for move to finish
#   {% endif %}
#   G90 ; set absolute positioning
#   STATUS_READY
#   UNDERGLOW_STANDBY
# axes: xyz
# set_position_z: 0 # This forces the z position to be at 0 when we start homing, so we can move the Z up before homing.


# [homing_override]
# axes: z
# set_position_z: 0
# gcode:
#     STATUS_HOMING
#     UNDERGLOW_HOMING
#     G0 Z10 F5000
#     G90
#     G28 Y347 X355
#     # Attach_Probe
#     G0 X175 Y175 F5000
#     G28 Z0
#     G0 Z20 F5000
#     G90
#     # G0 X33.00 F4000
#     # G0 Y347
#     G0 X175 F5000
#     G0 Y175 F5000
#     G90
#     STATUS_READY
#     UNDERGLOW_STANDBY

########################################
# TMC2209 configuration
########################################

## Motor1
#[tmc2209 stepper_x]
#uart_pin: PC13
##diag_pin: PF4 
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor2
#[tmc2209 stepper_y]
#uart_pin: PE3
##diag_pin: PF3
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor3
#[tmc2209 stepper_z]
#uart_pin: PB9
##diag_pin: PF2
#run_current: 0.650
#stealthchop_threshold: 999999

## Motor4
#[tmc2209 stepper_]
#uart_pin: PB5
##diag_pin: PF1
#run_current: 0.650
#stealthchop_threshold: 999999

## Motor5
#[tmc2209 extruder]
#uart_pin: PG14
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor6
#[tmc2209 extruder1]
#uart_pin: PG10
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor7
#[tmc2209 extruder2]
#uart_pin: PD5
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor8
#[tmc2209 extruder3]
#uart_pin: PC6
#run_current: 0.800
#stealthchop_threshold: 999999

########################################
# TMC2130 configuration
########################################

## Motor1
#[tmc2130 stepper_x]
#cs_pin: PC13
#spi_software_mosi_pin: PG6
#spi_software_miso_pin: PG7
#spi_software_sclk_pin: PG8
##diag1_pin: PF4
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor2
#[tmc2130 stepper_y]
#cs_pin: PE3
#spi_software_mosi_pin: PG6
#spi_software_miso_pin: PG7
#spi_software_sclk_pin: PG8
##diag1_pin: PF3
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor3
#[tmc2130 stepper_z]
#cs_pin: PB9
#spi_software_mosi_pin: PG6
#spi_software_miso_pin: PG7
#spi_software_sclk_pin: PG8
##diag1_pin: PF2
#run_current: 0.650
#stealthchop_threshold: 999999

## Motor4
#[tmc2130 stepper_]
#cs_pin: PB5
#spi_software_mosi_pin: PG6
#spi_software_miso_pin: PG7
#spi_software_sclk_pin: PG8
##diag1_pin: PF1
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor5
#[tmc2130 extruder]
#cs_pin: PG14
#spi_software_mosi_pin: PG6
#spi_software_miso_pin: PG7
#spi_software_sclk_pin: PG8
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor6
#[tmc2130 extruder1]
#cs_pin: PG10
#spi_software_mosi_pin: PG6
#spi_software_miso_pin: PG7
#spi_software_sclk_pin: PG8
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor7
#[tmc2130 extruder2]
#cs_pin: PD5
#spi_software_mosi_pin: PG6
#spi_software_miso_pin: PG7
#spi_software_sclk_pin: PG8
#run_current: 0.800
#stealthchop_threshold: 999999

## Motor8
#[tmc2130 extruder3]
#cs_pin: PC6
#spi_software_mosi_pin: PG6
#spi_software_miso_pin: PG7
#spi_software_sclk_pin: PG8
#run_current: 0.800
#stealthchop_threshold: 999999

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE7, EXP1_2=PG1,
    EXP1_3=PG0, EXP1_4=PF15,
    EXP1_5=PF14, EXP1_6=PF13,    # Slot in the socket on this side
    EXP1_7=PF12, EXP1_8=PF11,
    EXP1_9=<GND>, EXP1_10=<5V>,
    
    # EXP2 header
    EXP2_1=PE13, EXP2_2=PE12,
    EXP2_3=PE15, EXP2_4=PE11,
    EXP2_5=PE10, EXP2_6=PE14,      # Slot in the socket on this side
    EXP2_7=PE8, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=<NC>
    
    # See the sample-lcd.cfg file for definitions of common LCD displays.
    
    #[adxl345]
    #cs_pin: PA15
    #spi_bus: spi3a
    
    #[bltouch]
    #sensor_pin: PD13
    #control_pin: PD12
    
    ## Proximity switch
    #[probe]
    #pin: PD8
    
    #[output_pin ps_on_pin]
    #pin: PD14
    
    #[neopixel my_neopixel_1]
    #pin: PD15
    
    #[hall_filament_width_sensor]
    #adc1: PC0
    #adc2: PF10

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 22.885
#*# pid_ki = 1.557
#*# pid_kd = 84.103
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 64.323
#*# pid_ki = 1.548
#*# pid_kd = 668.151
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.458398, 0.346356, 0.275848, 0.230853, 0.198764, 0.163368, 0.150976, 0.149505, 0.155712, 0.169542, 0.189771, 0.226249, 0.272717, 0.343314, 0.424823
#*# 	0.382131, 0.286277, 0.232279, 0.183644, 0.144021, 0.119738, 0.108624, 0.108624, 0.113446, 0.138525, 0.165726, 0.212712, 0.259414, 0.318711, 0.373719
#*# 	0.350608, 0.266777, 0.210390, 0.163368, 0.126016, 0.102305, 0.095971, 0.092611, 0.098954, 0.119738, 0.150976, 0.195884, 0.247463, 0.308408, 0.356515
#*# 	0.343314, 0.260825, 0.201983, 0.150976, 0.119738, 0.095971, 0.091117, 0.081381, 0.092611, 0.108624, 0.138525, 0.186537, 0.236873, 0.302547, 0.354854
#*# 	0.338899, 0.254859, 0.189771, 0.138525, 0.102305, 0.087002, 0.074996, 0.065577, 0.074996, 0.092611, 0.119738, 0.163368, 0.212712, 0.275848, 0.341946
#*# 	0.320091, 0.230853, 0.163368, 0.110108, 0.078378, 0.055745, 0.042832, 0.036351, 0.044354, 0.067086, 0.094105, 0.137056, 0.186537, 0.254859, 0.331731
#*# 	0.309793, 0.212712, 0.144758, 0.092611, 0.055745, 0.029862, 0.008335, 0.005255, 0.018357, 0.036351, 0.060666, 0.095971, 0.157179, 0.236873, 0.320091
#*# 	0.302547, 0.201983, 0.132278, 0.086253, 0.049296, 0.014886, -0.003268, -0.007915, 0.005255, 0.024874, 0.055745, 0.095971, 0.155712, 0.233864, 0.325921
#*# 	0.280367, 0.194096, 0.126016, 0.074996, 0.031384, -0.001321, -0.023113, -0.026231, -0.018031, 0.001766, 0.029862, 0.074996, 0.138525, 0.212712, 0.303935
#*# 	0.280367, 0.201983, 0.132278, 0.071985, 0.024874, -0.011421, -0.029763, -0.036429, -0.029763, -0.007915, 0.026407, 0.073491, 0.133749, 0.212712, 0.308408
#*# 	0.284564, 0.201983, 0.132278, 0.063689, 0.015852, -0.023113, -0.043104, -0.056525, -0.044680, -0.018031, 0.016819, 0.068595, 0.138525, 0.214140, 0.308408
#*# 	0.283166, 0.195884, 0.119738, 0.049296, -0.001321, -0.043104, -0.063262, -0.070008, -0.056525, -0.036429, 0.005255, 0.060666, 0.132278, 0.218773, 0.308408
#*# 	0.292173, 0.189771, 0.100444, 0.029862, -0.029763, -0.075195, -0.102443, -0.106091, -0.095601, -0.065844, -0.019591, 0.042832, 0.114928, 0.212712, 0.315638
#*# 	0.325921, 0.191934, 0.098954, 0.018357, -0.048237, -0.089584, -0.118228, -0.125131, -0.107697, -0.075988, -0.024667, 0.049296, 0.132278, 0.236873, 0.362267
#*# 	0.376429, 0.201983, 0.084755, -0.004819, -0.070008, -0.109303, -0.125131, -0.131234, -0.125131, -0.095601, -0.043104, 0.037877, 0.132278, 0.258708, 0.410760
#*# x_count = 15
#*# y_count = 15
#*# mesh_x_pps = 3
#*# mesh_y_pps = 3
#*# algo = bicubic
#*# tension = 0.5
#*# min_x = 20.0
#*# max_x = 332.90000000000003
#*# min_y = 40.0
#*# max_y = 339.88000000000017
#*#
#*# [probe]
#*# z_offset = -0.810
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 58.8
#*# shaper_type_y = mzv
#*# shaper_freq_y = 39.8
